(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{200:function(t,e,a){"use strict";a.r(e);var n=a(0),r=Object(n.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_5-vue使用canvas绘制图片、矩形、线条、文字，下载图片"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-vue使用canvas绘制图片、矩形、线条、文字，下载图片","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. Vue使用Canvas绘制图片、矩形、线条、文字，下载图片")]),t._v(" "),a("h2",{attrs:{id:"_1-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-前言","aria-hidden":"true"}},[t._v("#")]),t._v(" 1 前言")]),t._v(" "),a("h3",{attrs:{id:"_1-1-业务场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-业务场景","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1 业务场景")]),t._v(" "),a("p",[t._v("图片储存在后台中，根据图片的地址，在vue页面中，查看图片，并根据坐标标注指定区域。")]),t._v(" "),a("p",[t._v("由于浏览器的机制，使用"),a("code",[t._v("window.location.href")]),t._v("下载图片时，并不会保存到本地，会在浏览器打开。")]),t._v(" "),a("h2",{attrs:{id:"_2-实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-实现原理","aria-hidden":"true"}},[t._v("#")]),t._v(" 2 实现原理")]),t._v(" "),a("h3",{attrs:{id:"_2-1-绘制画布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-绘制画布","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.1 绘制画布")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('<el-dialog\n    title="查看图片"\n    :visible.sync="dialogJPG"\n    append-to-body>\n    <canvas id="mycanvas" width="940" height="570"></canvas>\n</el-dialog>\n')])])]),a("p",[t._v("这里为了交互体验，使用了"),a("code",[t._v("element-ui")]),t._v("的弹窗方式。将canvas画布放到了弹窗中。")]),t._v(" "),a("p",[t._v("为了突出画布效果可以在css中设置一个边框。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#mycanvas {\n    border: 1px solid rgb(199, 198, 198);\n}\n")])])]),a("h3",{attrs:{id:"_2-2-绘制图片"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-绘制图片","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.2 绘制图片")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('//  imageUrl为后台提供图片地址\ndoDraw(imageUrl){\n    //  获取canvas\n    var canvas = document.getElementById("mycanvas")\n    //  由于弹窗，确保已获取到\n    var a = setInterval(() =>{\n        //  重复获取\n        canvas = document.getElementById("mycanvas")\n        if(!canvas){\n          return false\n        } else {\n            clearInterval(a)\n            //  可以理解为一个画笔，可画路径、矩形、文字、图像\n            var context = canvas.getContext(\'2d\')\n            var img = new Image()\n            img.src = imageUrl\n            //  加载图片\n            img.onload = function(){\n                if(img.complete){\n                    //  根据图像重新设定了canvas的长宽\n                    canvas.setAttribute("width",img.width)\n                    canvas.setAttribute("height",img.height)\n                    //  绘制图片\n                    context.drawImage(img,0,0,img.width,img.height)\n                }\n            }\n        }\n    },1)\n},\n')])])]),a("p",[a("code",[t._v("context.drawImage()")]),t._v("方法的参数介绍，可参照 "),a("a",{attrs:{href:"http://www.w3school.com.cn/html5/canvas_drawimage.asp",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("W3school")]),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_2-3-绘制矩形"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-绘制矩形","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.3 绘制矩形")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('context.strokeStyle = "red"\ncontext.lineWidth = 3;\ncontext.strokeRect(x, y, width, height)\n')])])]),a("p",[a("code",[t._v("context")]),t._v(" 同上面的定义")]),t._v(" "),a("p",[a("code",[t._v("strokeStyle")]),t._v(" 矩形颜色")]),t._v(" "),a("p",[a("code",[t._v("lineWidth")]),t._v(" 矩形边框宽度")]),t._v(" "),a("p",[a("code",[t._v("x,y,width,height")]),t._v(" 矩形位置加长宽")]),t._v(" "),a("h3",{attrs:{id:"_2-4-绘制线条"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-绘制线条","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.4 绘制线条")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('context.moveTo(x1,y1) \ncontext.lineTo(x2,y2)\ncontext.strokeStyle = "red"\ncontext.lineWidth = 3;\ncontext.stroke()\n')])])]),a("p",[a("code",[t._v("(x1,y1)")]),t._v(" "),a("code",[t._v("(x2,y2)")]),t._v(" 线条的起点和终点坐标")]),t._v(" "),a("p",[a("code",[t._v("strokeStyle")]),t._v(" "),a("code",[t._v("lineWidth")]),t._v(" 线条的样式")]),t._v(" "),a("h3",{attrs:{id:"_2-5-绘制文字"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-绘制文字","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.5 绘制文字")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("context.font = \"26px Arial bolder\"\ncontext.fillStyle = 'red'\ncontext.fillText(text,x,y)\n")])])]),a("p",[a("code",[t._v("font")]),t._v(" "),a("code",[t._v("fillStyle")]),t._v(" 文字样式")]),t._v(" "),a("p",[a("code",[t._v("text")]),t._v(" 文字内容")]),t._v(" "),a("p",[a("code",[t._v("x,y")]),t._v(" 文字显示坐标")]),t._v(" "),a("h3",{attrs:{id:"_2-6-下载图片"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-下载图片","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.6 下载图片")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 图片地址和图片名称\ndownIamge (imgsrc, name) { \n    let image = new Image()\n    image.setAttribute('crossOrigin', 'anonymous')\n    image.onload = function () {\n        let canvas = document.createElement('canvas')\n        canvas.width = image.width\n        canvas.height = image.height\n        let context = canvas.getContext('2d')\n        context.drawImage(image, 0, 0, image.width, image.height)\n        let url = canvas.toDataURL('image/jpg') \n        let a = document.createElement('a')\n        let event = new MouseEvent('click')\n        a.download = name\n        a.href = url\n        a.dispatchEvent(event)\n    }\n    image.src = imgsrc\n},\n")])])]),a("h2",{attrs:{id:"_3-后记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-后记","aria-hidden":"true"}},[t._v("#")]),t._v(" 3 后记")]),t._v(" "),a("p",[t._v("这里只是列出canvas的基础使用，具体的交互和展示还需要更多的设计。")]),t._v(" "),a("p",[a("strong",[t._v("感谢支持。若不足之处，欢迎大家指出，共勉。")])]),t._v(" "),a("p",[a("strong",[t._v("如果觉得不错，记得 点赞，谢谢大家")]),t._v(" 😂")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("欢迎关注 我的：")]),t._v(" "),a("a",{attrs:{href:"https://github.com/xrkffgg/Tools",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Github】"),a("OutboundLink")],1),a("a",{attrs:{href:"https://juejin.im/user/59c369496fb9a00a4843a3e2/posts",target:"_blank",rel:"noopener noreferrer"}},[t._v("【掘金】"),a("OutboundLink")],1),a("a",{attrs:{href:"https://www.jianshu.com/u/4ca4daac5890",target:"_blank",rel:"noopener noreferrer"}},[t._v("【简书】"),a("OutboundLink")],1),a("a",{attrs:{href:"https://blog.csdn.net/xrk_ffgg",target:"_blank",rel:"noopener noreferrer"}},[t._v("【CSDN】"),a("OutboundLink")],1),a("a",{attrs:{href:"https://my.oschina.net/xrkffgg",target:"_blank",rel:"noopener noreferrer"}},[t._v("【OSCHINA】"),a("OutboundLink")],1),a("a",{attrs:{href:"https://segmentfault.com/u/xrkffgg/articles",target:"_blank",rel:"noopener noreferrer"}},[t._v("【SF】"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"_3-1-参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.1 参考资料")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://www.w3school.com.cn/tags/tag_canvas.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3school"),a("OutboundLink")],1)])])])},[],!1,null,null,null);e.default=r.exports}}]);